<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Forecast</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <form id="weatherForm">
        <label for="city">Выберите city:</label>
        <select name="city" id="city">
            <option value="ufa">ufa</option>
            <option value="sibay">sibay</option>
            <option value="moscow">moscow</option>
        </select>

        <label for="period">Выберите period:</label>
        <select name="period" id="period">
            <option value="1">1</option>
            <option value="3">3</option>
            <option value="7">7</option>
        </select>
        <button type="submit">Send</button>
    </form>

    <table>
        <caption>Прогноз погоды в <span id="city_name"></span></caption>
        <thead>
            <tr id="daysRow">
                <th></th>
            </tr>
        </thead>
        <tbody id="weatherBody">
            <!-- Dynamic rows inserted here -->
        </tbody>
    </table>

    <script>

        async function fetchWeather(city, period) {
            // Replace with your real API endpoint
            const response = await fetch(`/api?city=${city}&period=${period}`);
            return await response.json();
        }

        function renderTable(city, data) {
            document.getElementById("city_name").textContent = city;

            // Render header row
            const daysRow = document.getElementById("daysRow");
            daysRow.innerHTML = "<th></th>"; // reset
            data.days.forEach(day => {
                const th = document.createElement("th");
                th.textContent = day.datetime;
                daysRow.appendChild(th);
            });

            // Render body
            const tbody = document.getElementById("weatherBody");
            tbody.innerHTML = ""; // reset

            data.params.forEach(param => {
                const tr = document.createElement("tr");
                const th = document.createElement("th");
                th.textContent = param[0];
                tr.appendChild(th);

                data.days.forEach(day => {
                    const td = document.createElement("td");
                    td.textContent = day[param[1]];
                    tr.appendChild(td);
                });

                tbody.appendChild(tr);
            });
        }

        document.getElementById("weatherForm").addEventListener("submit", async (e) => {
            e.preventDefault();
            const city = document.getElementById("city").value;
            const period = document.getElementById("period").value;
            const data = await fetchWeather(city, period);
            renderTable(city, data);
        });

        // Optionally load default
        fetchWeather("ufa", 1).then(data => renderTable("ufa", data));
    </script>
</body>
</html>